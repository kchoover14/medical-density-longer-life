<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.9.23">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Kara C. Hoover">

<title>Access to Health Care Workers Increases Life Expectancy</title>
<style>
/* Default styles provided by pandoc.
** See https://pandoc.org/MANUAL.html#variables-for-html for config info.
*/
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="medical-density-longer-life_files/libs/clipboard/clipboard.min.js"></script>
<script src="medical-density-longer-life_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="medical-density-longer-life_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="medical-density-longer-life_files/libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="medical-density-longer-life_files/libs/quarto-html/popper.min.js"></script>
<script src="medical-density-longer-life_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="medical-density-longer-life_files/libs/quarto-html/anchor.min.js"></script>
<link href="medical-density-longer-life_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="medical-density-longer-life_files/libs/quarto-html/quarto-syntax-highlighting-076ecbd647e1f0418c5051713cd9b730.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="medical-density-longer-life_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="medical-density-longer-life_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="medical-density-longer-life_files/libs/bootstrap/bootstrap-fdc35ccebf6ef883c9ad23e25989f106.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


</head>

<body class="blues quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#executive-summary" id="toc-executive-summary" class="nav-link active" data-scroll-target="#executive-summary">Executive Summary</a></li>
  <li><a href="#research-question" id="toc-research-question" class="nav-link" data-scroll-target="#research-question">Research Question</a></li>
  <li><a href="#research-answers" id="toc-research-answers" class="nav-link" data-scroll-target="#research-answers">Research Answers</a></li>
  <li><a href="#next-steps" id="toc-next-steps" class="nav-link" data-scroll-target="#next-steps">Next Steps</a></li>
  <li><a href="#study-design" id="toc-study-design" class="nav-link" data-scroll-target="#study-design">Study Design</a></li>
  <li><a href="#project-resources" id="toc-project-resources" class="nav-link" data-scroll-target="#project-resources">Project Resources</a></li>
  <li><a href="#tools-technologies" id="toc-tools-technologies" class="nav-link" data-scroll-target="#tools-technologies">Tools &amp; Technologies</a></li>
  <li><a href="#expertise" id="toc-expertise" class="nav-link" data-scroll-target="#expertise">Expertise</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Access to Health Care Workers Increases Life Expectancy</h1>
  <div class="quarto-categories">
    <div class="quarto-category">time series</div>
    <div class="quarto-category">linear regression</div>
    <div class="quarto-category">health care access</div>
    <div class="quarto-category">oral health</div>
    <div class="quarto-category">global health policy</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Kara C. Hoover </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">November 2023</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="executive-summary" class="level2">
<h2 class="anchored" data-anchor-id="executive-summary">Executive Summary</h2>
<p><strong>Problem:</strong> The UN is considering using part of its assistance budget to increase global life expectancy. Even before the COVID-19 pandemic, life expectancy was neither stable nor consistent across regions – the Americas experienced declines mid-decade in the 2010s, and even wealthy regions such as the EU and North America followed this trend, suggesting structural gaps in health system capacity. The WHO projects a shortfall of 10 million health workers by 2030, concentrated in low- and lower-middle-income countries, driven by underinvestment in training and increasing migration of health workers to wealthier nations.</p>
<p><strong>Approach:</strong> WHO Global Health Observatory data on density of dentists, medical doctors, and nurses/midwives (per 10,000 population) for 179 countries from 2000–2015 were merged with life expectancy data and analyzed using linear regression. Health worker density was modeled against life expectancy. Countries were stratified by a life expectancy threshold of 60 years to separate populations where health worker density is too low to have a measurable effect from those where targeted investment is most likely to produce gains.</p>
<p><strong>Insights:</strong> Dentist density has by far the largest effect on life expectancy. For countries with life expectancy at or above 60 years, each additional dentist per 10,000 people adds nearly one full year of life expectancy (eta-squared = 0.39). Each additional nurse or midwife adds approximately 18 days; the effect of medic density is negligible. Maximum global dentist density is just 15 per 10,000 – far below medics (75) and nurses/midwives (202) – meaning dentists represent both the largest effect and the greatest unmet supply.</p>
<p><strong>Significance:</strong> Oral disease affects nearly 3.5 billion people worldwide and is the most widespread noncommunicable disease tracked by the WHO – yet dental care is frequently excluded from health coverage and foreign assistance priorities. Investing in dentist density offers a high-leverage, evidence-based path to measurable gains in global life expectancy.</p>
<p><strong>Key Findings</strong></p>
<ul>
<li>Each additional dentist per 10,000 people increases life expectancy by 11.64 months; effect size is large (eta-squared = 0.39)</li>
<li>Nurse/midwife density adds approximately 18 days of life expectancy per additional provider per 10,000 people (eta-squared = 0.07); medic density has negligible impact</li>
<li>43 countries across Africa, Asia, and Oceania have health worker density below 1 per 10,000 and have the lowest life expectancy in the world – these are the primary targets for intervention</li>
<li>Global dentist density peaks at 15 per 10,000, far below medics (75) and nurses/midwives (202), indicating the greatest unmet need is in dental care</li>
</ul>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p><strong>Policy Recommendations</strong></p>
<ul>
<li>Direct assistance funds toward building basic health workforce capacity in the 43 countries with fewer than 1 worker per 10,000 people – these countries have the lowest life expectancy globally and density too low to benefit from targeted provider-type investment</li>
<li>In countries with life expectancy at or above 60, prioritize increasing dentist density – the effect size is large (eta-squared = 0.39) and global supply is severely constrained relative to other provider types</li>
<li>Expand inclusion of dental care in universal health coverage frameworks and assistance packages – oral disease affects 3.5 billion people and is the most common pathway from treatable infection to mortality</li>
<li>Re-examine effect sizes using post-2020 data before allocating new assistance funds – pandemic-driven workforce attrition and anticipated 2030 shortfalls may have shifted the relative impact of provider types</li>
</ul>
</div>
</div>
</div>
</section>
<section id="research-question" class="level2">
<h2 class="anchored" data-anchor-id="research-question">Research Question</h2>
<p>Does the density of health care workers increase global life expectancy, and which provider type – dentists, medical doctors, or nurses/midwives – has the greatest effect?</p>
</section>
<section id="research-answers" class="level2">
<h2 class="anchored" data-anchor-id="research-answers">Research Answers</h2>
<p>Life expectancy varied substantially across regions from 2000 to 2015. The time series below shows that even high-income regions experienced mid-decade declines, pointing to systemic vulnerabilities in health system capacity rather than country-specific shocks.</p>
<p><strong>Figure 1. Annual median life expectancy by region, 2000–2015.</strong></p>
<p><img src="annual_life_expectancy_by_region.png" class="img-fluid"></p>
<p><strong>Interpretation:</strong> The Americas show a notable decline in the mid-2010s – a pattern shared by EU and North American countries – suggesting that structural deficits in health workforce capacity affect even well-resourced regions. Africa and parts of Asia have the lowest life expectancy across the period.</p>
<p>A critical bifurcation exists in the data: in 43 countries with health worker density below 1 per 10,000 people (primarily in Africa, with additional countries in Asia and Oceania), density is too low to have a measurable effect on life expectancy. These countries – with a combined population experiencing the world’s lowest life expectancy – represent the primary targets for assistance investment aimed at increasing the health workforce. The three scatterplots below show the relationships between each provider type and life expectancy for the remaining countries, where density is sufficient to produce a detectable signal.</p>
<p><strong>Figure 2. Dentist density and life expectancy (countries with life expectancy &gt;= 60 years).</strong></p>
<p><img src="scatterplot_dentists_high_le.png" class="img-fluid"></p>
<p><strong>Interpretation:</strong> A clear positive relationship between dentist density and life expectancy – each additional dentist per 10,000 people adds nearly one full year of life expectancy. The effect is the strongest of the three provider types and holds across regions.</p>
<p>The magnitude of the dentist effect reflects the often-overlooked severity of untreated oral disease. A single carie (bacterial infection) may result in tooth loss, gum inflammation, and spread to other teeth; over time an abscess can lead to septicemia, a life-threatening condition even where medical care is otherwise adequate. Dental problems have been killing people since the origins of agriculture – as documented in <a href="https://www.worldcat.org/title/paleopathology-at-the-origins-of-agriculture">Cohen &amp; Armelagos (2013)</a> – and persist even in populations with access to other foods, as <a href="https://www.pnas.org/doi/full/10.1073/pnas.1318176111">Warinner et al.&nbsp;(2014)</a> show in hunter-gatherers who adopted starchier diets. The <a href="https://www.who.int/team/noncommunicable-diseases/global-status-report-on-oral-health-2022/">WHO Global Oral Health Status Report</a> finds that oral diseases are the most widespread noncommunicable diseases globally, affecting 3.5 billion people – yet dental care is routinely excluded from health coverage and assistance priorities. As <a href="https://www.scientificamerican.com/article/why-we-have-so-many-problems-with-our-teeth/">Scientific American</a> reports, dental caries is the most common chronic disease in the world, afflicting more than nine in ten Americans and billions globally.</p>
<p><strong>Figure 3. Medic density and life expectancy (countries with life expectancy &gt;= 60 years).</strong></p>
<p><img src="scatterplot_medics_high_le.png" class="img-fluid"></p>
<p><strong>Interpretation:</strong> Medic density shows a weak and inconsistent relationship with life expectancy in this dataset, with negligible effect size. This does not mean medics are unimportant – the finding likely reflects that basic medic density thresholds have already been met in this subset of countries, reducing marginal gains.</p>
<p><strong>Figure 4. Nurse and midwifery density and life expectancy (countries with life expectancy &gt;= 60 years).</strong></p>
<p><img src="scatterplot_nurses_high_le.png" class="img-fluid"></p>
<p><strong>Interpretation:</strong> Nurse and midwifery density has a small but statistically significant positive effect (eta-squared = 0.07), adding approximately 18 additional days of life expectancy per additional provider per 10,000 people.</p>
<p>The linear regression model (fit on countries with life expectancy &gt;= 60) quantifies the contribution of each provider type.</p>
<p><strong>Table 1. Linear regression results: health care worker density as predictors of life expectancy.</strong></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Term</th>
<th>Estimate</th>
<th>Std. Error</th>
<th>t-value</th>
<th>p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>(Intercept)</td>
<td>64.54</td>
<td>0.29</td>
<td>221.51</td>
<td>&lt; 0.001</td>
</tr>
<tr class="even">
<td>dentists</td>
<td>0.98</td>
<td>0.05</td>
<td>18.21</td>
<td>&lt; 0.001</td>
</tr>
<tr class="odd">
<td>medics</td>
<td>-0.05</td>
<td>0.01</td>
<td>-3.52</td>
<td>&lt; 0.001</td>
</tr>
<tr class="even">
<td>nursesMid</td>
<td>0.04</td>
<td>0.004</td>
<td>12.14</td>
<td>&lt; 0.001</td>
</tr>
</tbody>
</table>
<p><strong>Interpretation:</strong> Dentist density (estimate = 0.98) is the dominant predictor. The negative medic coefficient reflects complex co-linearity and the diminishing returns of medic density in countries that already have adequate medical coverage. The nurse/midwife coefficient is positive and significant, though the effect size is small.</p>
<p>Global dentist density is visually uneven, as the choropleth below shows. Large gaps in Africa are partly due to missing data and partly due to genuine near-zero density, consistent with the 43-country aid target list.</p>
<p><strong>Figure 5. Global dentist density per 10,000 population, 2000–2015.</strong></p>
<iframe src="dentist_density_map.html" width="100%" height="600px" frameborder="0">
</iframe>
<p><strong>Interpretation:</strong> Dentist density is heavily concentrated in high-income regions. Many African countries show missing values in the WHO data – a data gap that itself signals inadequate health system infrastructure. Targeted investment in these regions aligns directly with the modeled effect sizes.</p>
</section>
<section id="next-steps" class="level2">
<h2 class="anchored" data-anchor-id="next-steps">Next Steps</h2>
<p>The model presented here covers 2000–2015 – a pre-pandemic period. Several developments since then may have changed the underlying relationships and warrant re-examination.</p>
<p>The COVID-19 pandemic produced dramatic declines in life expectancy globally and exposed deep structural vulnerabilities in health workforce capacity. As reported in <a href="https://www.thelancet.com/journals/lanres/article/PIIS2213-2600(21)00068-0/fulltext">The Lancet</a>, front-line health care workers experienced widespread burnout, chronic stress, and PTSD, and lower-to-middle-income countries faced acute shortages of personal protective equipment alongside increased workload. Post-pandemic models comparing pre- and post-2020 trajectories would be the most useful tool for determining whether the effect sizes reported here remain stable or whether new intervention strategies are needed.</p>
<p>Additional priorities for future analysis:</p>
<ul>
<li>Regional-scale modeling – the current model is global; scaling at a regional level may improve predictive accuracy and identify more targeted intervention points</li>
<li>Re-examination of medic and nurse/midwife effect sizes post-pandemic, as workforce shortfalls anticipated by 2030 may increase their marginal impact</li>
<li>Investigation of mechanisms linking oral health to systemic mortality outcomes, particularly in contexts where dental care is excluded from universal health coverage</li>
</ul>
</section>
<section id="study-design" class="level2">
<h2 class="anchored" data-anchor-id="study-design">Study Design</h2>
<p><strong>Data Source:</strong> World Health Organization Global Health Observatory (WHO GHO), downloaded via public API; life expectancy data from a published Kaggle dataset (<a href="https://www.kaggle.com/datasets/lashagoch/life-expectancy-who-updated/">Gochiashvili</a>).</p>
<p><strong>Data Handling:</strong> Three WHO GHO indicators were downloaded via API: density of dentists (HWF_0010), medical doctors (HWF_0001), and nursing and midwifery personnel (HWF_0006), all per 10,000 population. Life expectancy at birth (WHOSIS_000001) was sourced from the Kaggle dataset. Data were filtered to 2000–2015 to align across sources. ISO3 country codes were added and datasets merged on country code and year. Rows with missing life expectancy values were removed. The final dataset covers 179 countries across 16 years. Analysis was stratified into two subsets: countries with life expectancy &gt;= 60 years (model subset) and &lt; 60 years (43-country aid target group where health worker density is below detectable effect thresholds).</p>
<p><strong>Analytical Approach:</strong></p>
<ol type="1">
<li>Summarized median life expectancy by region and year and plotted regional time series to characterize global trends</li>
<li>Tested the distribution of life expectancy using histograms and the <code>fitdistrplus</code> package; confirmed negative skew with a Weibull fit; log and square root transformations did not correct skew, so the untransformed variable was used with acknowledgment of this limitation – the goal is policy inference, not scientific precision</li>
<li>Assessed collinearity among predictors and outcome using a pairs panel (Spearman correlations)</li>
<li>Plotted scatterplots for the full dataset and for subsets above and below the life expectancy threshold of 60; identified 43 countries as primary intervention targets based on near-zero health worker density</li>
<li>Fit a linear regression model on the &gt;= 60 subset; assessed residuals and QQ plot – residual patterning consistent with non-normal outcome distribution is present but acceptable for the policy inference goal</li>
<li>Estimated effect sizes using eta-squared; exported tidy model results to CSV</li>
</ol>
</section>
<section id="project-resources" class="level2">
<h2 class="anchored" data-anchor-id="project-resources">Project Resources</h2>
<p><strong>Repository:</strong> <a href="https://github.com/kchoover14/medical-density-longer-life">github.com/kchoover14/medical-density-longer-life</a></p>
<p><strong>Data:</strong></p>
<ul>
<li>WHO GHO indicators (HWF_0010, HWF_0001, HWF_0006) downloaded via public API; life expectancy (WHOSIS_000001) from <a href="https://www.kaggle.com/datasets/lashagoch/life-expectancy-who-updated/">Kaggle</a> – both sources included in repo</li>
</ul>
<p><strong>Code:</strong></p>
<ul>
<li><code>medical-density-longer-life.R</code> – WHO API download, data cleaning and merging, time series and scatterplot figures, distribution analysis, collinearity check, linear regression with effect sizes, interactive choropleth map</li>
</ul>
<p><strong>Project Artifacts:</strong></p>
<ul>
<li><code>Life-Expectancy-Data-Updated.csv</code> – source life expectancy data from Kaggle (179 countries, 2000–2015)</li>
<li><code>who_density_life_expectancy_merged.csv</code> – merged WHO density and life expectancy dataset; final analysis input</li>
<li><code>dentist_density_map.html</code> – interactive choropleth of global dentist density</li>
<li><code>healthcare_density_regression_results.csv</code> – tidy linear regression model results (term, estimate, std.error, statistic, p.value)</li>
<li>Figures (n=10): time series, scatterplots by provider type (full dataset, &gt;= 60 subset, &lt; 60 subset)</li>
</ul>
<p><strong>Environment:</strong></p>
<ul>
<li><code>renv.lock</code> and <code>renv/</code> – restore with <code>renv::restore()</code></li>
</ul>
<p><strong>License:</strong></p>
<ul>
<li>Code and scripts © Kara C. Hoover, licensed under the <a href="LICENSE">MIT License</a>.</li>
<li>Data, figures, and written content © Kara C. Hoover, licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a>.</li>
</ul>
</section>
<section id="tools-technologies" class="level2">
<h2 class="anchored" data-anchor-id="tools-technologies">Tools &amp; Technologies</h2>
<p><strong>Languages:</strong> R</p>
<p><strong>Tools:</strong> RStudio | Quarto | GitHub Pages</p>
<p><strong>Packages:</strong> httr | jsonlite | countrycode | dplyr | tidyr | stringr | ggplot2 | plotly | htmlwidgets | fitdistrplus | car | psych | effectsize | broom</p>
</section>
<section id="expertise" class="level2">
<h2 class="anchored" data-anchor-id="expertise">Expertise</h2>
<p><strong>Domain Expertise:</strong> global health policy | statistical modeling | data visualization | WHO data access</p>
<p><strong>Transferable Expertise:</strong> Translates complex multi-source health system data into policy-ready evidence, identifying high-leverage intervention targets from regression findings for international development decision-making.</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>